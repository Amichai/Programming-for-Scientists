\input{slheader}
\title{Optimisation As A Programming Tool}
\begin{document}
\frame{\maketitle}

\begin{frame}[fragile]
\frametitle{Optimisation}

\begin{align*}
\min_x & f(x)\\
s.t.\,\,  &x \in S
\end{align*}

\end{frame}

\begin{frame}[fragile]
\frametitle{Simple Example}

\[
f(x) = x^4+4x^3-4x
\]

Let's look to minimise $f(x)$.

\end{frame}

\begin{frame}[fragile]

\centering
\includegraphics[width=.9\textwidth]{functionmin.pdf}

\end{frame}

\begin{frame}[fragile]
\frametitle{Taxonomy of Minimisation Problems}
\begin{align*}
\min_x & f(x)\\
s.t.\,\,  &x \in S
\end{align*}

\begin{itemize}
\item What is the form of $f$?
\item What is the form of $S$?
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Linear Least-Squares}

\[
\min_{\beta} (y - X\beta)^2;
\]

or find an approximation to

\[
y = X \beta,
\]

where $y \in R^{n} \beta \in R^m, X \in R^{n \times m}$, where $y$ and $X$ are given.

Linear least-squares has a closed-form \alert{fast} solution.

\end{frame}

\begin{frame}[fragile]
\frametitle{Two Solutions}

\begin{block}{Pseudo-Inverse}
\[
\hat{\beta} = (X X^T)^{-1}X^T y
\]
\end{block}

This is, generally, not a good idea.
\pause
\begin{block}{Use An Equation Solver}
\begin{python}
X = np.array(...)
y = np.array(...)
beta = scipy.linalg.leastsq(X,y)
\end{python}
\end{block}
\end{frame}

\begin{frame}[fragile]
\frametitle{Polynomial Fit}

Let's say you have one input variable~$x$ and an output $y$ and you want to fit a 3rd-degree polynomial.\\
Is this a linear regression?
\pause
Yes!

\[
y = \beta_3 x^3 + \beta_2 x^2 + \beta_1 x + \beta_0,
\]

can be written as

\[
y = [ x^3 x^2 x^1 1] [\beta_3 \beta_2 \beta_1 \beta_0 ]^{T}.
\]
\end{frame}

\begin{frame}[fragile]
\frametitle{Linear Programming}
\begin{block}{Linear Programming}
\begin{align*}
\min & c\cdot x\\
s.t.\,\,\,& Ax \le b
\end{align*}
\end{block}

\begin{block}{Example}
You can manufacture 3~types of widgets:
\begin{tabular}{lrrrrrr}
\toprule
      & $R_1$ & $R_2$ & $R_3$ & $R_4$ & $P$ \\
\midrule                      
$W_1$ &   10  &   20  &    9  &  0.1  & 20  \\
$W_2$ &    5  &    1  &   10  &    1  &  3  \\
$W_3$ &  100  &  120  &    9  &  1.8  & 90  \\
\bottomrule
\end{tabular}
\end{block}
\end{frame}

\begin{frame}[fragile]
\frametitle{Gradient Descent}

\centering
\includegraphics[width=.9\textwidth]{functionmin.pdf}

\end{frame}

\begin{frame}[fragile]
\frametitle{Gradient Descent}

\begin{enumerate}
\item Start with some prediction $x_0$
\item While \emph{not bored}
\begin{enumerate}
\item $x_{i+1} = x_i - \varepsilon f'(x_i)$
\end{enumerate}
\end{enumerate}
\end{frame}

\begin{frame}[fragile]

\begin{overprint}

\centering
\only<1>{\includegraphics[width=.9\textwidth]{graddesc-x02-2.pdf}}%
\only<2>{\includegraphics[width=.9\textwidth]{graddesc-x02-10.pdf}}%
\only<3>{\includegraphics[width=.9\textwidth]{graddesc-x02-25.pdf}}%
\only<4>{\includegraphics[width=.9\textwidth]{graddesc-x02-100.pdf}}

\end{overprint}
\end{frame}

\begin{frame}[fragile]

\begin{overprint}

\centering
\only<1>{\includegraphics[width=.9\textwidth]{graddesc-x0-2-2.pdf}}%
\only<2>{\includegraphics[width=.9\textwidth]{graddesc-x0-2-10.pdf}}%
\only<3>{\includegraphics[width=.9\textwidth]{graddesc-x0-2-25.pdf}}%
\only<4>{\includegraphics[width=.9\textwidth]{graddesc-x0-2-100.pdf}}

\end{overprint}
\end{frame}

\end{document}
